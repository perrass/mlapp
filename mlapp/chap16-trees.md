# Chap16-trees

### 数据集

| ID   | 年龄   | 有工作  | 有自己的房子 | 信贷情况 | 类别   |
| ---- | ---- | ---- | ------ | ---- | ---- |
| 1    | 青年   | 否    | 否      | 一般   | 否    |
| 2    | 青年   | 否    | 否      | 好    | 否    |
| 3    | 青年   | 是    | 否      | 好    | 是    |
| 4    | 青年   | 是    | 是      | 一般   | 是    |
| 5    | 青年   | 否    | 否      | 一般   | 否    |
| 6    | 中年   | 否    | 否      | 一般   | 否    |
| 7    | 中年   | 否    | 否      | 好    | 否    |
| 8    | 中年   | 是    | 是      | 好    | 是    |
| 9    | 中年   | 否    | 是      | 非常好  | 是    |
| 10   | 中年   | 否    | 是      | 非常好  | 是    |
| 11   | 老年   | 否    | 是      | 非常好  | 是    |
| 12   | 老年   | 否    | 是      | 好    | 是    |
| 13   | 老年   | 是    | 否      | 好    | 是    |
| 14   | 老年   | 是    | 否      | 非常好  | 是    |
| 15   | 老年   | 否    | 否      | 一般   | 否    |

### 公式

信息熵
$$
Ent(D) = -\sum^{|y|}_{k=1}p_klog_2p_k
$$
信息增益
$$
Gain(D, a) = Ent(D) - \sum^V_{v=1}{|D^v|\over|D|}Ent(D^v)
$$
信息增益率
$$
Gain\_ratio(D, a) = Gain(D, a) / IV(a)
$$

$$
IV(a) = -\sum^V_{v=1}{|D^v|\over|D|}log_2{|D^v|\over|D|}
$$
基尼系数
$$
Gini(D) = 1 - \sum^K_{k=1}p_k^2
$$

$$
Gini\_index(D, a) = \sum^V_{v=1}{|D^v|\over|D|}Gini(D^v)
$$

### 计算

#### 信息增益

信息熵
$$
Ent(D) = -\frac 9 {15} log_2 \frac 9 {15} - \frac 6 {15}log_2 \frac 6{15} = 0.971
$$
年龄
$$
\begin{align} Gain(D, 年龄)& = H(D) - [\frac 5 {15}H(D_1) + \frac 5 {15}H(D_2) + \frac 5 {15}H(D_3)] \\
	& = 0.971 - \frac 5 {15}[(-\frac 2 {5} log_2 \frac 2 {5} -\frac 3 {5} log_2 \frac 3 {5}) + (-\frac 3 {5} log_2 \frac 3 {5}-\frac 2 {5} log_2 \frac 2 {5}) + (-\frac 4 {5} log_2 \frac 4 {5} -\frac 1 {5} log_2 \frac 1 {5})] \\
	& = 0.971 - 0.888 = 0.083\\
\end{align}
$$

$$
Gain(D, 有工作) = 0.324 \\
Gain(D, 有房) = 0.420 \\
Gain(D, 信贷) = 0.363
$$

因此，第一个特征选择有房来进行分类

#### 基尼系数

年龄
$$
Gini(D, 年龄=青年) = \frac 5{15}(2\times \frac 2 5\times(1-\frac 2 5)) + \frac {10} {15}(2\times \frac 7 {10} \times (1-\frac 7 {10})) = 0.44\\
Gini(D, 年龄=中年) = 0.48\\
Gini(D, 年龄=老年) = 0.44\\
Gini(D, 有工作) = 0.32 \\
Gini(D, 有房) = 0.27 \\
Gini(D, 信贷情况=一般) = 0.36\\
Gini(D, 信贷情况=好) = 0.47\\
Gini(D, 信贷情况=非常好) = 0.32
$$
因此选择有房 